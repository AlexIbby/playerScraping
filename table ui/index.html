<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Ironman Rankings Dashboard</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <header class="page-header">
      <h1>NBA Ironman Rankings</h1>
      <p class="intro">
        This page visualizes the Ironman rankings generated by our pipeline. Use the filters to focus on specific teams, positions, or durability thresholds, then sort or remove players to explore how the rankings adjust in real time. During a draft you can delete players as they are picked to watch the remaining board re-rank instantly.
      </p>
    </header>

    <section class="layout">
      <aside id="filters-drawer" class="filters" aria-label="Filters">
        <button id="close-filters" type="button" class="drawer-close" aria-label="Close filters">Close</button>
        <h2>Filters</h2>
        <div class="filter-group" data-tooltip="Filter players by name. Type any part of the player name to match.">
          <label for="search-input">Search Players</label>
          <input id="search-input" type="search" placeholder="Search by name" />
        </div>

        <div class="filter-group" data-tooltip="Select one or more teams to limit the table to those rosters.">
          <label for="team-filter">Team</label>
          <select id="team-filter" multiple></select>
        </div>

        <div class="filter-group" data-tooltip="Select one or more positions to narrow the pool.">
          <label for="position-filter">Position</label>
          <select id="position-filter" multiple></select>
        </div>

        <div class="filter-group" data-tooltip="Only show players who appeared in at least this many games.">
          <label for="gp-min">Minimum Games Played</label>
          <input id="gp-min" type="range" min="0" max="82" value="0" />
          <output id="gp-min-value">0</output>
        </div>

        <div class="filter-group" data-tooltip="Switch between overall Ironman rank and the Good Ironman view that emphasizes production.">
          <span id="rank-toggle-label">Rank Basis</span>
          <div class="toggle">
            <input
              id="rank-basis-good"
              type="radio"
              name="rank-basis"
              value="goodIronman"
              checked
            />
            <label for="rank-basis-good">Good Ironman</label>
            <input
              id="rank-basis-core"
              type="radio"
              name="rank-basis"
              value="ironman"
            />
            <label for="rank-basis-core">Ironman</label>
          </div>
        </div>

      </aside>

      <main class="content">
        <div class="mobile-toolbar" aria-label="Mobile controls">
          <button
            id="mobile-filter-toggle"
            class="btn-secondary mobile-filter-btn"
            type="button"
            aria-expanded="false"
            aria-controls="filters-drawer"
          >
            Filters
          </button>
          <div class="mobile-sort" data-tooltip="Choose how players are ordered on small screens.">
            <label class="visually-hidden" for="mobile-sort-select">Sort players</label>
            <select id="mobile-sort-select" aria-label="Sort players">
              <option value="displayRank">Rank</option>
              <option value="currentScore">Score</option>
              <option value="GP">Games Played</option>
              <option value="MPG">Minutes (MPG)</option>
              <option value="ADP">ADP</option>
              <option value="team">Team</option>
              <option value="pos">Position</option>
              <option value="name_full">Player Name</option>
            </select>
            <button
              id="mobile-sort-direction"
              class="btn-secondary icon-btn"
              type="button"
              aria-label="Toggle sort direction"
              data-direction="asc"
            >
              Asc
            </button>
          </div>
        </div>
        <section class="summary" aria-live="polite">
          <div class="summary-row">
            <p id="summary-text">Loading players...</p>
            <div class="summary-actions">
              <button id="undo-remove" type="button" class="btn-secondary" disabled data-tooltip="Restore the most recently removed player.">Undo Delete</button>
              <button id="reset-filters" type="button" class="btn" data-tooltip="Reset all filters, sorts, and deletions to the default view.">Reset View</button>
            </div>
          </div>
          <div id="summary-chips" class="chip-row" aria-live="polite" aria-label="Active filters"></div>
        </section>

        <section class="table-wrapper" aria-labelledby="table-heading">
          <h2 id="table-heading">Player Table</h2>
          <div class="table-scroll" role="region" aria-live="polite">
            <table id="player-table" role="table">
              <thead>
                <tr>
                  <th scope="col" data-key="displayRank" data-tooltip="Live rank after filters, deletions, and the current sort are applied.">Rank</th>
                  <th scope="col" data-key="name_full" data-tooltip="Player name with the current team badge inside the row for quick scanning.">Player</th>
                  <th scope="col" data-key="team" data-tooltip="Latest NBA team abbreviation from the rankings feed.">Team</th>
                  <th scope="col" data-key="pos" data-tooltip="Eligible fantasy positions supplied by the pipeline output.">Pos</th>
                  <th scope="col" data-key="currentScore" data-tooltip="Primary Ironman score for the selected rank basis; higher is better.">Score</th>
                  <th scope="col" data-key="GP" data-tooltip="Regular-season games counted toward the durability model.">GP</th>
                  <th scope="col" data-key="MPG" data-tooltip="Average minutes per game derived from total minutes divided by games played.">MPG</th>
                  <th scope="col" data-key="ADP" data-tooltip="Yahoo average draft position; shows N/A when a value is unavailable.">ADP</th>
                  <th scope="col" data-key="actions" data-tooltip="Open expanded metrics or delete a player to simulate a draft pick and trigger a re-rank.">Actions</th>
                </tr>
              </thead>
              <tbody>
                <tr><td colspan="9" class="loading">Fetching data...</td></tr>
              </tbody>
            </table>
          </div>
          <div id="card-list" class="card-list" hidden aria-live="polite"></div>
        </section>
      </main>
    </section>

    <div id="drawer-overlay" class="drawer-overlay" hidden></div>

    <div id="tooltip" role="tooltip" aria-hidden="true" hidden></div>

    <script
      src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"
      integrity="sha384-D/t0ZMqQW31H3az8ktEiNb39wyKnS82iFY52QPACM+IjKW3jDUhyIgh2PApRqJZs"
      crossorigin="anonymous"
    ></script>
    <script src="app.js" type="module"></script>
  </body>
</html>
